!function(){"use strict";var CSV=function(t){var e=function(t){return!(!t||null===t)};return t=e(t)?t:{},this.options={delimiter:e(t.delimiter)?t.delimiter:",",header:e(t.header)?t.header:!1,stream:e(t.stream)?t.stream:void 0,done:e(t.done)?t.done:void 0},this};CSV.format={cast:function(t){var e=t.toLowerCase();return""===e?void 0:isNaN(Number(t))?"true"===e||"t"===e||"yes"===e||"y"===e?!0:"false"===e||"f"===e||"no"===e||"n"===e?!1:(t=t.trim(),'"'===t.charAt(0)&&(t=t.substring(1,t.length)),'"'===t.charAt(t.length-1)&&(t=t.substring(0,t.length-1)),t.replace(/\"\"/g,'"')):Number(t)},stringify:function(t){return isNaN(Number(t))?'"'+t.replace(/\"/,'""')+'"':t},encode:function(t){return t.map(CSV.format.stringify).join(",")+"\r\n"}},CSV.prototype.set=function(t,e){return this.options[t]=e,e},CSV.prototype.encode=function(t){var e,r,n,o,i,a;return e=[],r=t[0]instanceof Array?"array":"object",o=this.options.header,i=this.options.stream||[].push,a=this.options.done,"object"===r?(n=o&&o instanceof Array?o:Object.keys(t[0]),i.call(e,CSV.format.encode(n)),t.forEach(function(t){t=n.map(function(e){return t[e]}),i.call(e,CSV.format.encode(t))})):(o&&o instanceof Array&&i.call(e,CSV.format.encode(o)),t.forEach(function(t){i.call(e,CSV.format.encode(t))})),a?a(e):e.join("")},CSV.prototype.parse=function(t){var e,r,n,o,i,a;e=[],r=this.options.delimiter,n=this.options.stream||[].push,o=this.options.done,i=this.options.header,a=i instanceof Array?i:!1;var s,c,f,u,d,h,l,m;s={},c={},f=t.length,u=0,d=0,m=function(){if(u>=f)return c;if(l)return l=!1,s;var e=u;if(34===t.charCodeAt(e)){for(var n=e;n++<f;)if(34===t.charCodeAt(n)){if(34!==t.charCodeAt(n+1))break;n+=1}return u=n+2,o=t.charCodeAt(n+1),13===o?(l=!0,10===t.charCodeAt(n+2)&&(n+=1)):10===o&&(l=!0),t.substring(e+1,n)}for(;f>u;){var o=t.charCodeAt(u++),i=1;if(10===o)l=!0;else if(13===o)l=!0,10===t.charCodeAt(u)&&(++u,++i);else if(o!==r.charCodeAt(0))continue;return t.substring(e,u-i)}return t.substring(e)};for(var p,y;(h=m())!==c;){for(p=[];h!==s&&h!==c;)p.push(h),h=m();if(""!==p[0]&&1!==p.length)if(a&&a.length){y={},p=p.map(CSV.format.cast);for(var g=0,A=a.length;A>g;++g)y[a[g]]=p[g];n.call(e,y)}else i?a=(i instanceof Array?i:p).map(CSV.format.cast):n.call(e,p.map(CSV.format.cast))}return o?o(e):e},"function"==typeof define&&define.amd?define(CSV):"object"==typeof module&&module.exports?module.exports=CSV:window.CSV=CSV}();