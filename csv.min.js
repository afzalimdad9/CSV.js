!function(){"use strict";var CSV=function(t){var e=function(t){return!(!t||null===t)};return t=e(t)?t:{},this.options={delimiter:e(t.delimiter)?t.delimiter:",",header:e(t.header)?t.header:!1,stream:e(t.stream)?t.stream:void 0,done:e(t.done)?t.done:void 0},this};CSV.format={cast:function(t){var e=t.toLowerCase();return""===e?void 0:isNaN(Number(t))?"true"===e||"t"===e||"yes"===e||"y"===e?!0:"false"===e||"f"===e||"no"===e||"n"===e?!1:(t=t.trim(),'"'===t.charAt(0)&&(t=t.substring(1,t.length)),'"'===t.charAt(t.length-1)&&(t=t.substring(0,t.length-1)),t.replace(/\"\"/g,'"')):Number(t)},stringify:function(t){return isNaN(Number(t))?'"'+t.replace(/\"/,'""')+'"':t},encode:function(t){return t.map(CSV.format.stringify).join(",")+"\r\n"}},CSV.prototype.set=function(t,e){return this.options[t]=e,e},CSV.prototype.encode=function(t){var e,r,o,n,i,a;return e=[],r=t[0]instanceof Array?"array":"object",n=this.options.header,i=this.options.stream||[].push,a=this.options.done,"object"===r?(o=Object.keys(t[0]),i.call(e,CSV.format.encode(o)),t.forEach(function(t){t=o.map(function(e){return t[e]}),i.call(e,CSV.format.encode(t))})):(n&&n instanceof Array&&i.call(e,CSV.format.encode(n)),t.forEach(function(t){i.call(e,CSV.format.encode(t))})),a?a(e):e.join("")},CSV.prototype.parse=function(t){var e,r,o,n,i,a;e=[],r=this.options.delimiter,o=this.options.stream||[].push,n=this.options.done,i=this.options.header,a=i instanceof Array?i:!1;var s,c,f,u,d,h,l,m;s={},c={},f=t.length,u=0,d=0,m=function(){if(u>=f)return c;if(l)return l=!1,s;var e=u;if(34===t.charCodeAt(e)){for(var o=e;o++<f;)if(34===t.charCodeAt(o)){if(34!==t.charCodeAt(o+1))break;o+=1}return u=o+2,n=t.charCodeAt(o+1),13===n?(l=!0,10===t.charCodeAt(o+2)&&(o+=1)):10===n&&(l=!0),t.substring(e+1,o)}for(;f>u;){var n=t.charCodeAt(u++),i=1;if(10===n)l=!0;else if(13===n)l=!0,10===t.charCodeAt(u)&&(++u,++i);else if(n!==r.charCodeAt(0))continue;return t.substring(e,u-i)}return t.substring(e)};for(var p,g;(h=m())!==c;){for(p=[];h!==s&&h!==c;)p.push(h),h=m();if(""!==p[0]&&1!==p.length)if(a&&a.length){g={},p=p.map(CSV.format.cast);for(var y=0,v=a.length;v>y;++y)g[a[y]]=p[y];o.call(e,g)}else i?a=(i instanceof Array?i:p).map(CSV.format.cast):o.call(e,p.map(CSV.format.cast))}return n?n(e):e},"function"==typeof define&&define.amd?define(CSV):"object"==typeof module&&module.exports?module.exports=CSV:window.CSV=CSV}();