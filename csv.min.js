!function(){"use strict";var CSV=function(e){var t=function(e){return!(!e||null===e)};return e=t(e)?e:{},this.options={delimiter:t(e.delimiter)?e.delimiter:",",header:t(e.header)?e.header:!1,stream:t(e.stream)?e.stream:void 0,done:t(e.done)?e.done:void 0},this};CSV.format={cast:function(e){return e=e.toLowerCase().trim(),""===e?void 0:isNaN(Number(e))?"true"===e||"t"===e||"yes"===e||"y"===e?!0:"false"===e||"f"===e||"no"===e||"n"===e?!1:void 0:Number(e)},stringify:function(e){return isNaN(Number(e))?'"'+e.replace(/\"/,'""')+'"':e},encode:function(e){return e.map(CSV.format.stringify).join(",")+"\r\n"}},CSV.prototype.set=function(e,t){return this.options[e]=t,this.options},CSV.prototype.encode=function(e){var t,o,r,n,i,a;return t=[],o=e[0]instanceof Array?"array":"object",n=this.options.header,i=this.options.stream||[].push,a=this.options.done,"object"===o?(r=Object.keys(e[0]),i.call(t,CSV.format.encode(r)),e.forEach(function(e){e=r.map(function(t){return e[t]}),i.call(t,CSV.format.encode(e))})):(n&&n instanceof Array&&i.call(t,CSV.format.encode(n)),e.forEach(function(e){i.call(t,CSV.format.encode(e))})),a?a(t):t.join("")},CSV.prototype.parse=function(e){var t,o,r,n,i,a,c,s,l;t=[],o=this.options.stream||[].push,r=this.options.done,n=this.options.header,i=n instanceof Array?n:[],a={row:[],cell:""},c={escaped:!1,quote:!1,cell:!0},s=function(e){c.escaped&&(e=e.slice(1,-1).replace(/""/g,'"')),a.row.push(CSV.format.cast(e)),a.cell="",c={escaped:!1,quote:!1,cell:!0}},l=function(){if(i&&i.length){for(var e={},r=0,c=i.length;c>r;++r)e[i[r]]=a.row[r];o.call(t,e)}else n?i=n instanceof Array?n:data:o.call(t,a.row);a.row=[]};for(var d,u=0,f=0,p=e.length,h=this.options.delimiter.charCodeAt(0);p>=f;++f)d=e.charCodeAt(f),c.cell&&(c.cell=!1,34===d)?c.escaped=!0:c.escaped&&34===d?c.quote=!c.quote:(c.escaped&&c.quote||!c.escaped)&&(d===h?(s(a.cell+e.slice(u,f)),u=f+1):(10===d||f===p)&&(s((a.cell+e.slice(u,f)).slice(0,-1)),u=f+1,l()));return r?r(t):t},"function"==typeof define&&define.amd?define(CSV):"object"==typeof module&&module.exports?module.exports=CSV:window.CSV=CSV}();