!function(){"use strict";var CSV=function(e){var o=function(e){return!(!e||null===e)};return e=o(e)?e:{},this.options={delimiter:o(e.delimiter)?e.delimiter:",",header:o(e.header)?e.header:!1,stream:o(e.stream)?e.stream:void 0,done:o(e.done)?e.done:void 0},this};CSV.format={cast:function(e){return e=e.toLowerCase().trim(),""===e?void 0:isNaN(Number(e))?"true"===e||"t"===e||"yes"===e||"y"===e?!0:"false"===e||"f"===e||"no"===e||"n"===e?!1:void 0:Number(e)},stringify:function(e){return isNaN(Number(e))?'"'+e.replace(/\"/,'""')+'"':e},encode:function(e){return e.map(CSV.format.stringify).join(",")+"\r\n"}},CSV.prototype.set=function(e,o){return this.options[e]=o,this.options},CSV.prototype.encode=function(e){var o,t,r,n,i,c;return o=[],t=e[0]instanceof Array?"array":"object",n=this.options.header,i=this.options.stream||[].push,c=this.options.done,"object"===t?(r=Object.keys(e[0]),i.call(o,CSV.format.encode(r)),e.forEach(function(e){e=r.map(function(o){return e[o]}),i.call(o,CSV.format.encode(e))})):(n&&n instanceof Array&&i.call(o,CSV.format.encode(n)),e.forEach(function(e){i.call(o,CSV.format.encode(e))})),c?c(o):o.join("")},CSV.prototype.parse=function(e){var o,t,r,n,i,c,a,s,l;o=[],t=this.options.stream||[].push,r=this.options.done,n=this.options.header,i=n instanceof Array?n:[],c={row:[],cell:""},a={escaped:!1,quote:!1,cell:!0},s=function(e){a.escaped&&(e=e.slice(1,-1).replace(/""/g,'"')),c.row.push(CSV.format.cast(e)),c.cell="",a={escaped:!1,quote:!1,cell:!0}},l=function(){if(i&&i.length){for(var e={},r=0,a=i.length;a>r;++r)e[i[r]]=c.row[r];t.call(o,e)}else n?i=n instanceof Array?n:c.row:t.call(o,c.row);c.row=[]};for(var d,u=0,f=0,p=e.length,h=this.options.delimiter.charCodeAt(0);p>=f;++f)d=e.charCodeAt(f),a.cell&&(a.cell=!1,34===d)?a.escaped=!0:a.escaped&&34===d?a.quote=!a.quote:(a.escaped&&a.quote||!a.escaped)&&(d===h?(s(c.cell+e.slice(u,f)),u=f+1):(10===d||f===p)&&(s((c.cell+e.slice(u,f)).slice(0,-1)),u=f+1,l()));return r?r(o):o},"function"==typeof define&&define.amd?define(CSV):"object"==typeof module&&module.exports?module.exports=CSV:window.CSV=CSV}();